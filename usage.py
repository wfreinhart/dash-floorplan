import dash_floorplan
import dash
from dash.dependencies import Input, Output
import dash_html_components as html
import pathlib
import os

cwd = pathlib.Path(__file__).parent.absolute()
print('image exists? ' + str(os.path.isfile('%s/dash-logo.png' % cwd)))
app = dash.Dash(__name__)

app.layout = html.Div([
    dash_floorplan.DashFloorPlan(
        id='input',
        width=1024,
        height=768,
        # data=[
        #     {"points": [{"x": 0.616, "y": 0.424}, {"x": 0.951, "y": 0.424}, {"x": 0.951, "y": 0.030}, {"x": 0.616, "y": 0.030}], "color": 0.4},
        #     {"points": [{"x": 0.042, "y": 0.424}, {"x": 0.350, "y": 0.424}, {"x": 0.350, "y": 0.030}, {"x": 0.042, "y": 0.030}], "color": 0.8},
        #     ],
        data=[
            {'points': [{'x': 0.6494140625, 'y': 0.9453125}, {'x': 0.98828125, 'y': 0.9479166666666666}, {'x': 0.9892578125, 'y': 0.5859375}, {'x': 0.65234375, 'y': 0.5885416666666666}], 'color': 0.1},
            {'points': [{'x': 0.009765625, 'y': 0.515625}, {'x': 0.3779296875, 'y': 0.5182291666666666}, {'x': 0.3818359375, 'y': 0.14713541666666666}, {'x': 0.010749999433755875, 'y': 0.14979166785875955}], 'color': 0.2},
            {'points': [{'x': 0.38671875, 'y': 0.14713541666666666}, {'x': 0.6455078125, 'y': 0.14453125}, {'x': 0.6455078125, 'y': 0.07291666666666667}, {'x': 0.9853515625, 'y': 0.08072916666666667}, {'x': 0.98828125, 'y': 0.5885416666666666}, {'x': 0.37890625, 'y': 0.5872395833333334}], 'color': 0.3},
            {'points': [{'x': 0.3779296875, 'y': 0.5885416666666666}, {'x': 0.642578125, 'y': 0.5911458333333334}, {'x': 0.6416015625, 'y': 0.9466145833333334}, {'x': 0.3837890625, 'y': 0.9427083333333334}], 'color': 0.4},
            {'points': [{'x': 0.0068359375, 'y': 0.9453125}, {'x': 0.189453125, 'y': 0.9453125}, {'x': 0.185546875, 'y': 0.76171875}, {'x': 0.2177734375, 'y': 0.7630208333333334}, {'x': 0.21484375, 'y': 0.5234375}, {'x': 0.009765625, 'y': 0.5234375}], 'color': 0.5},
            {'points': [{'x': 0.193359375, 'y': 0.7669270833333334}, {'x': 0.375, 'y': 0.7682291666666666}, {'x': 0.373046875, 'y': 0.94921875}, {'x': 0.1943359375, 'y': 0.9479166666666666}], 'color': 0.6},
            {'points': [{'x': 0.220703125, 'y': 0.5221354166666666}, {'x': 0.376953125, 'y': 0.5234375}, {'x': 0.37890625, 'y': 0.7604166666666666}, {'x': 0.2197265625, 'y': 0.7565104166666666}], 'color': 0.7},
            {'points': [{'x': 0.12109375, 'y': 0.048177083333333336}, {'x': 0.2763671875, 'y': 0.046875}, {'x': 0.2734375, 'y': 0.14322916666666666}, {'x': 0.1220703125, 'y': 0.14453125}], 'color': 0.8}
        ],
        image='https://online.visual-paradigm.com/repository/images/e5728e49-09ce-4c95-b83c-482deee24386.png',
    ),
    html.Div(id='output')
])

@app.callback(Output('output', 'children'), [Input('input', 'data')])
def display_output(value):
    return 'Current polygons: %s' % str(value)


if __name__ == '__main__':
    app.run_server(debug=True)
